{% extends "timeline/base.html" %}

	{% block content %}	
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
			{% if not categories %}
				<h2>열심히 공부해볼까요?</h2>
				<p>달력이 비어있네요. 먼저 요즘 어떤 공부를 하고 있는지 카테고리들을 먼저 추가하고, 날짜별 공부일정을 등록해보세요.</p>
			{% else %}
				<h2>열심히 공부하고 있습니다</h2>
			{% endif %}
			</div>
		</div>

		{% if categories %}
		<div class="row">
			<div class="col-lg-12">
				<h4>오늘 공부 추가하기</h4>
				<form class="form-horizontal" action="{% url 'add' %}" method="post">
					{% csrf_token %}
					<div class="form-group">
						<label for="title" class="col-lg-2 control-label">Title</label>
						<div class="col-lg-10">
							<input type="text" class="form-control" name="title" id="title" placeholder="오늘 뭘 하셨나요?">
						</div>
					</div>
					<div class="form-group">
						<label for="date" class="col-lg-2 control-label">Date</label>
						<div class="col-lg-10">
							<input type="date" class="form-control" format="yyyy-mm-dd" name="date" id="date">
						</div>
					</div>
					<div class="form-group">
						<label for="contents" class="col-lg-2 control-label">Details</label>
						<div class="col-lg-10">
							<textarea class="form-control" rows="3" name="contents" id="contents"></textarea>
						</div>
					</div>
					<div class="form-group">
						<label class="col-lg-2 control-label">Categories</label>
						<div class="col-lg-10">
						{% for category in categories %}

							<label class="checkbox-inline">
								<input type="checkbox" name="category" id="category-{{ category.id }}" value="{{category.name}}"> {{ category }}
							</label>
						{% endfor %}
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-offset-2 col-lg-10">
							<button type="submit" class="btn btn-default">등록</button>
						</div>
					</div>
				</form>
			</div>
		</div>

		<div class="row">
			<div class="col-lg-12">
	 			<form action="{% url 'delete' %}" method="post">
				{% csrf_token %}
					<div class="table-responsive">
					<table class="table">
						<tr>
							<th></th>
							<th>date</th>
							<th>title</th>
							{% for cat in categories %}
							<th>{{cat.name}}</th>
							{% endfor %} 
						</tr>
					
						{% for study in study_list %}
						<tr>
							<td><input type="checkbox" name="item" value="{{ study.id }}" /></td>
							<td>{{ study.date|date:"Y-m-d" }}</td>
							<td><a href="/{{study.id}}">{{ study.title }}</a></td>
							{% for cat in categories %}
							<td>
							{% if cat.name in study.cat %}
							O
							{% endif %}
							</td>
							{% endfor %}
						</tr>
						{% endfor %}
					</table>
					</div>
					<button type="submit" class="btn btn-default">삭제</button>
				</form>
			</div>
		</div>
		{% endif %}
	</div>
	<div class="container">
		<div class="row">
			<hr>
		</div>
	</div>
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<form class="form-inline" action="{% url 'catadd' %}" method="post">
				{% csrf_token %}
					<div class="form-group">
						<label for="name">새 카테고리</label>
						<input type="text" class="form-control" name="name" id="name" placeholder="기타">
					</div>
	  				<button type="submit" class="btn btn-default">추가</button>
				</form>
			</div>
		</div>
		<div class="row" style="margin-top:10px">
			<div class="col-lg-12">
				<form class="form-inline" action="{% url 'catdelete' %}" method="post">
				{% csrf_token %}
					<div class="form-group">
						{% for cat in categories %}
						<label class="checkbox-inline">
							<input type="checkbox" name="cat_name" value="{{ cat.id }}"> {{ cat.name }}
						</label>
						{% endfor %}
					</div>
					<button type="submit" class="btn btn-default">카테고리 삭제</button>
				</form>
			</div>
		</div>
	</div>

	{% endblock %}
